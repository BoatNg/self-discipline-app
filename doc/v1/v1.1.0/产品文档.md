# 记录页升级 PRD（产品说明文档）

## 1. 背景与目标

随着产品进入长期使用阶段，原有以「日志列表」为核心的记录页已无法满足用户的主要诉求：

* 用户更关心 **当前状态与持续性**，而非逐条历史
* 多任务并行成为常态，需要清晰的结构承载
* 记录应当提供正反馈，而不是复盘压力

**本次升级目标：**

* 将记录页升级为「行为与任务进度总览页」
* 强化连续感、降低认知负担
* 明确连续天数的统一计算规则，保证长期一致性

---

## 2. 页面结构定义

### 2.1 页面角色划分

| 页面          | 角色定位                 |
| ----------- | -------------------- |
| 记录总览页（新）    | 多任务行为状态与连续进度总览（默认入口） |
| 记录详情页（旧记录页） | 全量日志查看（唯一详情入口）       |

> 记录详情页仅承担“查看历史”的职责，不参与状态判断与计算。

---

## 3. 记录总览页结构

记录总览页分为三部分，自上而下：

1. 行为日历（任务并行视图）
2. 任务连续进度列表
3. 统一详情入口

---

### 3.1 行为日历（任务并行视图）

#### 定位

* 以“天”为横轴
* 同时展示 **每一项任务在当天的状态**
* 类似 macOS 日历中「同一天多条事件并列展示」的模式

> 日历回答的问题是：
> **“这一天里，我的每个任务分别进行得如何？”**

#### 核心原则

* 不做跨任务聚合
* 不合并结果、不下结论
* 每个任务在每一天都有独立状态

---

### 3.2 日历状态定义（展示层）

> 日历状态的最小单位为：**任务 × 日期**

| 状态    | 含义         |
| ----- | ---------- |
| 🟢 成功 | 该任务在当天为成功日 |
| 🔴 失败 | 该任务在当天为失败日 |
| ⚪️ 空白 | 该任务在当天为未知日 |

---

### 3.3 不同任务类型在日历中的表现

#### 【我想要】任务（主动建设型）

| 日历状态 | 判定规则       |
| ---- | ---------- |
| 🟢   | 当天成功打卡     |
| 🔴   | 当天未打卡或打卡失败 |

#### 【我不要】任务（冲动抑制型）

| 日历状态 | 判定规则           |
| ---- | -------------- |
| 🟢   | 当天不存在任何一次“没扛住” |
| 🔴   | 当天至少一次“没扛住”    |
| ⚪️   | 当天无任何相关记录      |

> 日历仅做事实映射，不参与连续结算。

---

## 4. 任务连续进度列表

### 4.1 定位

* 展示用户当前正在坚持的任务
* 明确每个任务的「最近连续天数」
* 提供核心动机与正反馈

---

### 4.2 展示内容（每项任务）

* 任务名称
* 任务类型（我想要 / 我不要）
* 最近连续天数（整数）

不展示：

* 历史最长连续
* 失败详情
* 单日明细

---

## 5. 连续天数计算总原则

> **连续天数 = 符合该任务“成功定义”的连续自然日数量**

* 连续以“天”为最小单位
* 判断基于结果，而非是否记录
* 不同任务类型使用不同成功标准

---

## 6. 【我想要】任务连续规则

### 成功日定义

* 当天存在打卡记录
* 且 `isCompleted = true`

### 中断条件

* 当天未打卡
* 或打卡但 `isCompleted = false`

### 连续计算方式

* 从今天向前逐天回溯
* 遇到首个非成功日即中断

---

## 7. 【我不要】任务连续规则（重点）

### 7.1 核心判断问题

> “这一天，我是否成功做到『不做那件事』？”

---

### 7.2 日级状态归一化

无论一天内发生多少次冲动记录，必须先聚合为单一日状态。

| 日状态    | 含义          |
| ------ | ----------- |
| ✅ 成功日  | 当天未发生失败行为   |
| ❌ 失败日  | 当天至少一次“没扛住” |
| ⚪️ 未知日 | 当天无任何相关记录   |

> 未知 ≠ 失败

---

### 7.3 冲动记录到日状态的映射

| 冲动记录状态 | 对日状态影响       |
| ------ | ------------ |
| 扛住了    | 判定为成功日       |
| 没扛住    | 判定为失败日（立即中断） |
| 未完成    | 不影响结果        |
| 未记录    | 不影响结果        |

---

### 7.4 连续计算规则

#### 成功条件（当天）

* 当天不存在任何一次「没扛住」

#### 中断条件（唯一）

* 当天至少一次「没扛住」

#### 连续计算方式

* 从今天开始向前回溯
* 遇到首个失败日即停止

---

## 8. 统一详情入口

* 记录总览页底部仅保留一个入口：
  **「查看全部记录」**
* 进入后展示完整日志列表（原记录页）
* 不支持从日历或任务直接跳转局部详情

---

## 9. 产品价值与设计原则（必须遵守）

* 失败是事实，不是惩罚
* 未记录不等于失败
* 连续用于鼓励坚持，而非制造压力
* 系统不替用户做道德判断

---

**本 PRD 为记录页升级与连续天数计算的唯一规则依据。**
